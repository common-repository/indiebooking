function addCategoryListItem(e){var a=jQuery("#span_meta_dummy_rsappartmentcategories");if(a.length>0){var t=jQuery("<li/>").attr("id","rsappartmentcategories-"+e.data.termId),o=jQuery(a).clone(),n=jQuery(o).find("#in-dummy_rsappartmentcategories"),i=jQuery(o).find("label[for='in-dummy_rsappartmentcategories']");jQuery(o).removeClass("ibui_hiddenMetaSpan"),jQuery(o).attr("id","span_meta_rsappartmentcategories-"+e.data.termId),jQuery(n).attr("value",e.data.name),jQuery(n).attr("name","tax_input[rsappartmentcategories][]"),jQuery(n).attr("checked","checked"),jQuery(n).attr("id","in-rsappartmentcategories-"+e.data.termId),jQuery(i).attr("for","in-rsappartmentcategories-"+e.data.termId),jQuery(i).html(e.data.name),jQuery(o).appendTo(t),jQuery("#taxonomy-rsappartmentcategories").find("ul").append(jQuery(t).hide().fadeIn(2e3))}}function addAdminTaxonomy(e){if(ibui_indiebooking_check_and_show_save_button(jQuery(e))){var a=!1,t="",o=jQuery(e).find("input, textarea, select").serialize(),n=jQuery("#_wpnonce_add-tag").val(),i=jQuery(e).data("process");if("undefined"!=typeof n&&n!==!1&&(a=!0),1==a){var r="",_="",p="",u="",d="",c="";"add"===i?(r="rs_ib_save_new_taxonomy_admin",_=jQuery("#addtag").find("input[name='_wp_http_referer']").val(),p=jQuery("#addtag").find("input[name='taxonomy']").val(),u=jQuery("#addtag").find("input[name='screen']").val(),d=jQuery("#addtag").find("input[name='post_type']").val(),t="action="+r+"&screen="+u+"&taxonomy="+p+"&post_type="+d+"&_wpnonce_add-tag="+n+"&_wp_http_referer="+_+"&"+o):"edit"==i&&(r="rs_ib_edit_taxonomy",p=jQuery(e).data("taxonomy"),c=jQuery(e).data("tagID"),d=jQuery(e).data("postType"),_=jQuery(e).data("httpRef"),t="action="+r+"&taxonomy="+p+"&post_type="+d+"&tag_ID="+c+"&_wpnonce_add-tag="+n+"&_wp_http_referer="+_+"&"+o)}else p=jQuery(e).attr("data-taxonomy"),t="action=rs_ib_save_new_taxonomy&taxonomy="+p+"&"+o;var s=jQuery.ajax({type:"POST",url:indiebooking_admin_popup_ajaxObject.ajaxURL,data:t,beforeSend:function(){jQuery(document).trigger("showHideLoadingContext",[!0])}});s.done(function(t,o,n){if(1==t.success)if(jQuery(e).data("process",""),jQuery(e).data("taxonomy",""),jQuery(e).data("tagID",""),jQuery(e).data("postType",""),jQuery(e).data("httpRef",""),jQuery(e).dialog("close"),1==a){if("add"==i){var r=t.data,_=jQuery.parseXML(r[0]),p=jQuery(_).find("parents"),u=p.text();jQuery("#the-list").prepend(jQuery(u).hide().fadeIn(2e3))}else if("edit"==i){var d=jQuery("#the-list").find("#tag-"+t.data.termId),c=jQuery(d).find(".column-name"),s=jQuery(c).find(".row-title"),y=jQuery(c).find("#inline_"+t.data.termId);jQuery(y).find(".name").html(t.data.name),jQuery(s).html(t.data.name),jQuery(s).attr("aria-label",t.data.name);var l=jQuery(c).find(".row-actions").find(".edit");switch(jQuery(l).find("a").attr("aria-label",t.data.name),jQuery(d).find(".column-description").html(t.data.description),e){case"#rs_ib_taxonomy_category_popup":break;case"#rs_ib_taxonomy_campaign_popup":jQuery(d).find(".column-value").html(t.data.preis),jQuery(d).find(".column-forAllApartments").html(t.data.allApartmentsActive),jQuery(d).find(".column-campaign_type").html(t.data.aktionTypeDesc),jQuery(d).find(".column-calculation_type").html(t.data.valueTypeDesc);break;case"#rs_ib_taxonomy_coupon_popup":jQuery(d).find(".column-code").html(t.data.code),jQuery(d).find(".column-description").html(t.data.description),jQuery(d).find(".column-availableNumbers").html(t.data.availableNumber+"/"+t.data.number),jQuery(d).find(".column-forAllAppartments").html(t.data.allApartmentActive),jQuery(d).find(".column-combineable").html(t.data.combinable);break;case"#rs_ib_taxonomy_real_gutschein_popup":jQuery(d).find(".column-code").html(t.data.code),jQuery(d).find(".column-description").html(t.data.description),jQuery(d).find(".column-availableNumbers").html(t.data.availableNumber+"/"+t.data.number),jQuery(d).find(".column-forAllAppartments").html(t.data.allApartmentActive);break;case"#rs_ib_taxonomy_option_popup":jQuery(d).find(".column-price").html(t.data.preis),jQuery(d).find(".column-calculation").html(t.data.calcTypeDesc)}}}else switch(e){case"#rs_ib_taxonomy_campaign_popup":"undefined"!=typeof ibui_indiebooking_addCampaignListItem&&jQuery.isFunction(ibui_indiebooking_addCampaignListItem)&&ibui_indiebooking_addCampaignListItem(t);break;case"#rs_ib_taxonomy_coupon_popup":"undefined"!=typeof ibui_indiebooking_addCouponListItem&&jQuery.isFunction(ibui_indiebooking_addCouponListItem)&&ibui_indiebooking_addCouponListItem(t);break;case"#rs_ib_taxonomy_category_popup":addCategoryListItem(t);break;case"#rs_ib_taxonomy_option_popup":"undefined"!=typeof ibui_indiebooking_addOptionListItem&&jQuery.isFunction(ibui_indiebooking_addOptionListItem)&&ibui_indiebooking_addOptionListItem(t)}else{var m="";if(1==a&&"add"==i)if(t.data.hasOwnProperty("responses")){var b=jQuery.parseXML(t.data.responses[0]),g=jQuery(b).find("wp_error");m=g.length>0?g[0].textContent:"unknown error"}else m=t.data;else m=t.data;ibui_indiebooking_errorAdminDialog("Error",m)}}),s.fail(function(e,a,t){alert(t)}),s.always(function(){jQuery(document).trigger("showHideLoadingContext",[!1])})}else{var y=jQuery(e).prop("scrollHeight"),l=jQuery(e).outerHeight(),m=y-l;jQuery(e).animate({scrollTop:m},850)}}function checkPopupCheckbox(e,a,t,o){"undefined"!=typeof o&&0!=o||(o="on"),jQuery(a).val(t),t==o?(jQuery(e).prop("checked",!0),jQuery(e).parent("div").hasClass("ibui_switchbtn")&&jQuery(e).parent("div").addClass("ibui_switchbtn_active")):(jQuery(e).prop("checked",!1),jQuery(e).parent("div").hasClass("ibui_switchbtn")&&jQuery(e).parent("div").removeClass("ibui_switchbtn_active"))}function loadTaxonomy(e,a,t,o){var n=jQuery.ajax({type:"POST",url:indiebooking_admin_popup_ajaxObject.ajaxURL,data:{action:"rs_ib_load_taxonomy",termId:e,taxonomy:a,security:indiebooking_admin_popup_ajaxObject.ib_ajax_nonce},beforeSend:function(){jQuery(document).trigger("showHideLoadingContext",[!0])}});n.done(function(e,a,n){switch(o.dialog("open"),t){case"#rs_ib_taxonomy_category_popup":jQuery("#category-tag-name").val(e.data.name),jQuery("#category-tag-description").val(e.data.description)}}),n.always(function(){jQuery(document).trigger("showHideLoadingContext",[!1])})}function selectPopupApartments(e){jQuery("#apartment_check_table").find(".cb_apartment_check_table_all_active_kz").val(e.data.allApartmentsActive),"on"!=e.data.allApartmentsActive&&"true"!=e.data.allApartmentsActive||jQuery("#apartment_check_table").find(".cb_apartment_check_table_all_active").prop("checked",!0),jQuery.each(e.data.validApartmentIds,function(e,a){var t=jQuery("#apartment_check_table").find(".cb_apartment_check_table_id[value='"+a+"']");jQuery(t).closest(".table_active_kz").find(".cb_apartment_check_table_active").prop("checked",!0),jQuery(t).closest(".table_active_kz").find(".cb_apartment_check_table_active_kz").val("on")}),jQuery.each(e.data.dutyApartmentIds,function(e,a){var t=jQuery("#apartment_check_table").find(".cb_apartment_check_table_id[value='"+a+"']");jQuery(t).closest(".table_active_kz").find(".cb_apartment_check_table_duty_active").prop("checked",!0),jQuery(t).closest(".table_active_kz").find(".cb_apartment_check_table_duty_active_kz").val("on")})}function rs_indiebooking_initial_ApartmentView_Popups(){jQuery("#rs_ib_taxonomy_category_popup").length>0&&jQuery("#rs_ib_taxonomy_category_popup").dialog({autoOpen:!1}),jQuery("#rs_ib_taxonomy_coupon_popup").length>0&&jQuery("#rs_ib_taxonomy_coupon_popup").dialog({autoOpen:!1}),jQuery("#rs_ib_taxonomy_campaign_popup").length>0&&jQuery("#rs_ib_taxonomy_campaign_popup").dialog({autoOpen:!1}),jQuery("#rs_ib_taxonomy_option_popup").length>0&&jQuery("#rs_ib_taxonomy_option_popup").dialog({autoOpen:!1})}function ibui_indiebooking_get_taxonomy_data_from_link(e){var a={},t=jQuery(e).attr("href"),o=t.indexOf("taxonomy="),n=t.indexOf("tag_ID="),i=t.indexOf("post_type="),r=t.indexOf("wp_http_referer="),_=t.substring(o,n),p=t.substring(n,i),u=t.substring(i,r),d=t.substring(r);return _=_.replace("taxonomy=",""),_=_.replace("&",""),p=p.replace("tag_ID=",""),p=p.replace("&",""),u=u.replace("post_type=",""),u=u.replace("&",""),d=d.replace("wp_http_referer=",""),d=d.replace("&=",""),a.taxonomy=_,a.tagID=p,a.postType=u,a.httpRef=d,a}function ibui_indiebooking_set_dialog_data(e,a){return e.data("process","edit"),e.data("taxonomy",a.taxonomy),e.data("tagID",a.tagID),e.data("postType",a.postType),e.data("httpRef",a.httpRef),e}function ibui_indiebooking_open_taxonomy_popup(e){var a=ibui_indiebooking_get_taxonomy_data_from_link(e),t=a.taxonomy,o=a.tagID,n=(a.postType,a.httpRef,null);switch(t){case"rsappartmentcategories":n=categoryDialog;break;default:var i=this.href;window.location=i}if(null!==n){var r="#"+jQuery(n).attr("id");n=ibui_indiebooking_set_dialog_data(n,a),loadTaxonomy(o,t,r,n)}}function ibui_indiebooking_check_and_show_save_button(e){var a=jQuery(e).scrollTop(),t=jQuery(e).prop("scrollHeight"),o=jQuery(e).outerHeight(),n=t-o;return a==n}function ibui_indiebooking_switch_next_save_button(e){var a=jQuery(e).closest("div.ui-dialog"),t=jQuery(a).find(".rs_ib_taxonomy_popup_btn_save"),o=jQuery(a).find(".rs_ib_taxonomy_popup_btn_next");ibui_indiebooking_check_and_show_save_button(this)?(jQuery(t).show(),jQuery(o).hide()):(jQuery(t).hide(),jQuery(o).show())}jQuery(document).ready(function(){categoryDialog=jQuery("#rs_ib_taxonomy_category_popup").dialog({autoOpen:!1,height:530,width:650,modal:!0,resizable:!1,title:jQuery("#rs_ib_taxonomy_category_popup").attr("data-dialogTitle"),buttons:{SaveButton:{text:indiebooking_popup_txt.btnSave,id:"rs_ib_taxonomy_category_popup_btn_save","class":"rs_ib_taxonomy_popup_btn",click:function(){addAdminTaxonomy("#rs_ib_taxonomy_category_popup")}},CancelButton:{text:indiebooking_popup_txt.btnCancel,id:"rs_ib_taxonomy_category_popup_btn_cancel","class":"rs_ib_taxonomy_popup_btn",click:function(){categoryDialog.dialog("close")}}},open:function(){jQuery("#category-tag-name").val(""),jQuery("#category-tag-description").val("")},close:function(){}}),jQuery("#rs_ib_taxonomy_option_popup_form").on("submit",function(e){}),jQuery("#wpbody-content").on("click","#rs_ib_btn_create_category",function(e){e.preventDefault(),categoryDialog.data("process","add"),categoryDialog.dialog("open")}),jQuery(".ibui_body_wrapper.taxonomy-rsappartmentcategories").on("click","span.edit a",function(e){e.preventDefault(),ibui_indiebooking_open_taxonomy_popup(jQuery(this))}),jQuery(".ibui_body_wrapper.taxonomy-rsappartmentcategories").on("click","td.column-name strong a",function(e){e.preventDefault(),ibui_indiebooking_open_taxonomy_popup(jQuery(this))}),window.indiebookingGlobalUiController.registerToggleListener("#rs_ib_post_booking_contact_popup")});