function getZabutoInDatelineArray(e,t,a,r,n,o,i,s,l,u){var d=0,g=0,y=0,_=0,b=0,f=0,c=null,p=null,h=null,j=new Date,Q=null,v=null;for(j.setHours(0,0,0,0),"undefined"!=typeof u&&"undefined"!=u||(u=!1),"undefined"!=typeof l&&""!=l&&"0"!=l||(l=1),"undefined"!=typeof s&&""!==s?(Q=s.month-1,v=s.year):(Q=j.getMonth(),v=j.getFullYear()),"string"==typeof o&&(o=parseEuroStringToDate(o)),"string"==typeof i&&(i=parseEuroStringToDate(i)),d=0;d<e.length;d++){if(g=e[d].date_from,y=e[d].date_to,"undefined"!=typeof g&&""!==g&&(g=g.substring(0,10)),"undefined"!=typeof y&&""!==y&&(y=y.substring(0,10)),p=null,h=null,"undefined"!=typeof g&&""!==g)p="string"==typeof g?new Date(g):g;else var p=new Date;p||console.log("PROBLEM KEIN DATUM"),"undefined"!=typeof y&&""!==y&&(h="string"==typeof y?new Date(y):y),h||(h=new Date(f,b,_));var D=p,k=t;for("booked"==a&&(k=t+" booked_first_disabled");D<=h;){var m=new Date(D);if(m.getTime()>=j.getTime()||u){c=m.getDay(),0==c&&(c=7);var S=m.getMonth();if(S>=Q&&S<=Q+l||0==S&&Q+l==13){var w=m.toISOString();w=w.substring(0,10),null!=o&&null!=i&&m>=o&&m<=i||("booked"==a&&m.getTime()===h.getTime()&&(k=t+" booked_last_disabled"),"booked"!=a&&"bookable"!=a||(jQuery.inArray(c.toString(),n)>=0||n.length<=0)&&(k+=" arrivalday",n.length<=0&&(k+=" arrivalday_green"))),r.push({date:w,badge:!1,classname:k,label:a})}if(v==D.getFullYear()&&Q+l==D.getMonth())break}k=t,D=new Date(D.getTime()+864e5)}}return r}function parseStringToEuroDateString(e){var t=e.getFullYear(),a=e.getMonth()+1,r=e.getDate();a<10&&(a="0"+a),r<10&&(0==r&&(r=1),r="0"+r);var n=r+"."+a+"."+t;return n}function parseStringToEuroDateStringWithoutYear(e){var t=e.getMonth()+1,a=e.getDate();t<10&&(t="0"+t),a<10&&(0==a&&(a=1),a="0"+a);var r=a+"."+t;return r}function parseUSStringToDate(e,t){var a=null,r=0,n=0,o=0;if("undefined"!=typeof e&&""!==e)o=e.substr(0,4),n=e.substr(5,2),r=e.substr(8,2),n=parseInt(n)-1;else if(t){var i=new Date;r=i.getDate(),n=i.getMonth(),o=i.getFullYear()}return r>0&&n>=0&&o>0&&(a=new Date(o,n,r)),a}function parseEuroStringToDate(e,t){var a=null,r=0,n=0,o=0;if("undefined"!=typeof e&&""!==e)r=e.substr(0,2),n=e.substr(3,2),n=parseInt(n)-1,o=e.substr(6,9);else if(t){var i=new Date;r=i.getDate(),n=i.getMonth(),o=i.getFullYear()}return r>0&&n>=0&&o>0&&(a=new Date(o,n,r)),a}function getZabutoCalendarDates(e,t,a,r,n,o,i){var s=[];if(s=getZabutoInDatelineArray(e,"bookeddisabled","booked",s,a,r,n,o,i),s=getZabutoInDatelineArray(t,"notbookable","notbookable",s,a,r,n,o,i),s.length<=0&&e.length>0){var l="booked",u="bookeddisabled";jQuery.each(e,function(){var e=this.datum;if("undefined"!=typeof e){var t=new Date(e);t=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));var a=t.toISOString();a=a.substring(0,10),s.push({date:a,badge:!1,classname:u,label:l})}})}return s}function refreshDataByNavigation(e,t){var a=jQuery(e),r=JSON.parse(jQuery(a).attr("data-booked")),n=(JSON.parse(jQuery(a).attr("data-bookable")),JSON.parse(jQuery(a).attr("data-bookableeng")),JSON.parse(jQuery(a).attr("data-notbookabledates"))),o=JSON.parse(jQuery(a).attr("data-arrivaldays")),i=jQuery(a).attr("data-currentvon"),s=jQuery(a).attr("data-currentbis"),l=jQuery(a).attr("data-minnaechte"),u=getZabutoCalendarDates(r,n,o,i,s,t,l);return u}function fillDateFields(e,t){var a,r="#"+e,n=jQuery(r).closest(".calendar-dow"),o=jQuery(n).closest(".rs_ib_floating_datepicker_container");if(o.length>0)a=o.find(".rs_ib_floating_datepicker_from"),toField=o.find(".rs_ib_floating_datepicker_to");else if(jQuery(r).closest(".rs_ib_popup_datepicker_container").length>0){var i=jQuery(r).closest(".rs_ib_popup_datepicker_container");a=i.find(".rs_ib_floating_datepicker_from"),toField=i.find(".rs_ib_floating_datepicker_to")}else if(jQuery(n).closest("#found_appartment_list").length>0&&jQuery("#search_booking_date_from").length>0)a=jQuery("#search_booking_date_from"),toField=jQuery("#search_booking_date_to");else if(jQuery(n).closest("#buchungsplugin_startseite_such_box").length>0){var s=jQuery(n).closest(".ibfkt_indiebooking_search_box_container");a=jQuery(s).find(".rs_ib_floating_datepicker_from"),toField=jQuery(s).find(".rs_ib_floating_datepicker_to")}else jQuery(n).closest("#apartment_detail").length>0?(i=jQuery(n).closest(".entry-content").find(".apartment_info_container"),a=i.find(".booking_date_from"),toField=i.find(".booking_date_to")):jQuery(n).closest("#appartment_list_box").length>0&&(i=jQuery(n).closest(".entry-content").find(".apartment_detail"),a=i.find(".booking_date_from"),toField=i.find(".booking_date_to"));var l=jQuery("#"+e).closest(".zabuto_calendar"),u=jQuery(l).closest(".rs_ib_calendar_data_container"),d="#"+jQuery(u).attr("id"),g=jQuery(d),y=!1,_=jQuery(g).data("firstdate"),b=jQuery(g).data("lastdate"),f="",c="";if("undefined"==typeof _&&(_=""),"undefined"==typeof b&&(b=""),""==b&&0==t){if(jQuery(g).data("firstdate",""),a.length>0&&a.val(""),toField.length>0&&toField.val(""),jQuery(a).hasClass("rs_ib_error_popover")){var p=jQuery("#rs_ib_msg_wrong_arrival_day").val();jQuery(a).popover({content:p,placement:"top",trigger:"manual"}),jQuery(a).popover("show")}}else{if(jQuery(a).hasClass("rs_ib_error_popover")&&(jQuery(a).popover("hide"),jQuery(a).popover("destroy")),""!==_)if(jQuery(g).data("yearless")){var h=Date.parse(_);0==isNaN(h)?_=new Date(_):(yearlessyear=jQuery(g).data("yearlessYear"),_=_.replace(yearlessyear,"2016"),_=new Date(_)),f=parseStringToEuroDateStringWithoutYear(_),_=parseStringToEuroDateString(_)}else _=new Date(_),_=parseStringToEuroDateString(_),f=_;if(""!==b){if(jQuery(g).data("yearless")){var j=Date.parse(b);0==isNaN(j)?b=new Date(b):(yearlessyear=jQuery(g).data("yearlessYear"),b=b.replace(yearlessyear,"2016"),b=new Date(b)),c=parseStringToEuroDateStringWithoutYear(b),b=parseStringToEuroDateString(b)}else b=new Date(b),b=parseStringToEuroDateString(b),c=b;1==u.data("isPopupFloatingCalendar")&&(y=!0)}else("undefined"==typeof toField||jQuery(toField).length<=0)&&1==u.data("isPopupFloatingCalendar")&&(y=!0);if(a.length>0&&a.val(f),toField.length>0&&(toField.val(c),toField.trigger("change")),jQuery("#buchung_header").length>0&&a.length>0&&toField.length>0&&""!==a.val()&&""!==toField.val(),y){var s=jQuery(u).closest(".rs_ib_floating_calender_popup_container"),Q=s.attr("id");jQuery("#"+Q).data("beforeClose");"function"==typeof jQuery("#"+Q).data("beforeClose")&&(y=jQuery("#"+Q).data("beforeClose")(jQuery("#"+Q),_,b)),y&&jQuery(u).closest(".rs_ib_floating_calender_popup_container").hide()}}}function showZabutoCalendars(){jQuery(".rs_zabuto-calendar").length&&jQuery(".rs_zabuto-calendar").each(function(e){var t=(jQuery(this),JSON.parse(jQuery(this).attr("data-booked"))),a=(JSON.parse(jQuery(this).attr("data-bookable")),JSON.parse(jQuery(this).attr("data-bookableeng")),JSON.parse(jQuery(this).attr("data-notbookabledates"))),r=JSON.parse(jQuery(this).attr("data-arrivaldays")),n=jQuery(this).attr("data-currentvon"),o=jQuery(this).attr("data-currentbis"),i=jQuery(this).attr("data-maxDate"),s=new Date(i),l=new Date,u=l.getMonth()+1,d=l.getFullYear(),g=!1;if(jQuery("#synchronize_zabuto_calendars").length>0&&"true"==jQuery("#synchronize_zabuto_calendars").attr("data-synchronize")&&(g=!0),"undefined"!=typeof n&&n!==!1)""!=n&&(u=parseInt(n.substring(3,5)),d=parseInt(n.substring(6,10)));else if(n="",jQuery("#search_booking_date_from").length){var y=jQuery("#search_booking_date_from").val();""!=y&&(u=parseInt(y.substring(3,5)))}"undefined"!=typeof o&&o!==!1||(o="");var _={month:u,year:d},b=u,f=d;u=l.getMonth()+1,d=l.getFullYear();jQuery(this).indiebooking_calendar({cell_border:!1,today:!0,show_previous:!1,show_next:!0,language:ibui_zabutotxt.language,month:u,year:d,startMonth:b,startYear:f,max_date:s,arrivalDays:r,disable_old_days:!0,enable_date_picker:!0,sync_date_picker:g,data:getZabutoCalendarDates(t,a,r,n,o,_),legend:[{type:"block",label:ibui_zabutotxt.bookedTxt,classname:"bookeddisabled"},{type:"block",label:ibui_zabutotxt.freeTxt,classname:"bookedenabled"},{type:"block",label:ibui_zabutotxt.arrivaldayTxt,classname:"arrivalday"},{type:"block",label:ibui_zabutotxt.mindaterange,classname:"mindaterange"}],action:function(){if(jQuery(this).closest("#currently_booked_dates").length>0)return"";var e=!1;return jQuery(this).find(".day").hasClass("arrivalday")&&(e=!0),fillDateFields(this.id,e)},action_nav:function(){},action_refresh_date_data:function(e,t){var a=refreshDataByNavigation(e.getHTMLCalendarObject(),t);e.refreshCalendarEventdata(a)},action_afterdraw:function(e){}})})}jQuery(document).ready(function(e){showZabutoCalendars()});